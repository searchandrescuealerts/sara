<html>
<head>
	<meta charset="utf-8">
	<title>Search and Rescue Alerts</title>
	<link rel="stylesheet" type="text/css" href="/stylesheets/style2.css">
	<link href='http://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Exo+2:400,300,200,500' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro:900' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Baumans' rel='stylesheet' type='text/css'>
	<script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyA3mC_xSILKVBUECReJLJbyoX9L3PQ_ApY&sensor=false"></script>
	<script src="/javascripts/googlemaps.js" rel="javascript" type="text/javascript"></script>
</head>
<body>

<script type="text/javascript" src="http://code.jquery.com/jquery-1.6.3.min.js"></script>

<div id="rotatingBanner">
	<img src="/images/banner7.jpg" class="rotateImg"/>
</div>

<center>
<div id="main">
	<div id="header" class="white wide section">
		<div id="account">
			<span class="button orangeBG blackBorder" onclick="login()">Log In</span>
		</div>
		<img src="/images/logo/1-logo-long-horizontal.png" class="logo"/>
	</div>

	<div id="banner" class="wide section">
		<div class="bannerWords">
			<p><a href="#signup" class="button orangeBG whiteBorder">Sign Up Now</a></p>
			<h1><b>A &quot;missing&quot; poster in the palm of your hand</b></h1>
		</div>
	</div>

	<div id="about" class="blue wide section">
		<a name="aboutSection"></a>
		<div class="content">
			<div class="right">
				<h1>How SARA Came To Be</h1>
				<!-- <iframe width="100%" height="40%" src="//www.youtube-nocookie.com/embed/_X5kNTl1nNM?rel=0" frameborder="0" allowfullscreen></iframe> -->
			</div>
			<h1>About SARA</h1>
			
			<p>SARA (Search and Rescue Alerts) engages the power of the public to bring missing persons home. When someone is reported as “missing,” the first moments are the most critical. SARA immediately sends a text message to your mobile device so you can keep an eye out as you go about your daily activities. Messages include a link to photos, current information, and details about organized searches. You become part of a vast community of concerned searchers with “eyes on the ground.” You can help bring a missing person swiftly and safely home.</p>

			<center><h2>“I would want everyone looking for my child if something went wrong.”</h2></center>

			<p>To receive notifications of missing persons in your area, register to be a SARA citizen today. There is no charge to register.</p>

			<center><h3>You never know when you will see something that makes the difference. Just being alert on the roads, at the store, and in your neighborhood will help.</h3></center>

			<div style="clear: both;"></div>
		</div>
	</div>

	<div id="how" class="inverted wide section">
		<a name="howSection"></a>
		<div class="content">
			<h1>How It Works</h1>

			<center>
			<div class="steps">
				<div class="step">
					<img src="/images/signup2.png" />
					<h2>Step 1</h2>
					<h3>Sign Up</h3>
					<p><a href="#signup" class="button orangeBG whiteBorder">Sign Up</a> by providing your texting number and location.</p>
				</div>
				
				<div class="step">
					<img src="/images/sms2.png" />
					<h2>Step 2</h2>
					<h3>Receive Alerts</h3>
					<p>You will receive texts about missing persons in your area and a link to the latest information about the case, along with a phone number where tips can be sent immediately.</p>
				</div>

				<div class="step">
					<img src="/images/binoculars.png" />
					<h2>Step 3</h2>
					<h3>Begin Searching</h3>
					<p>Start your search from exactly where you are.  By being alert, you could make the difference in finding a person and even saving a life.</p>
				</div>
			</div>
			</center>

			<div style="clear:both;">
				<p><b>Sign up now to receive notifications and help find missing persons while going about your daily routines.</b></p>
			</div>
		</div>
		<div style="clear:both;"></div>
	</div>

	<div id="signup" class="blue wide section">
		<div class="content">
			<h1>Sign Up</h1>
			<p>Sign up now to receive notifications on your mobile device and help search for missing persons while going about your daily routine. <a href="#faq">Read the Frequently Asked Questions.</a></p>
			
			<p>Already a member?<br /><span class="button blueBG blackBorder"> Update your information </span>

			<div class="signupForm left">

				<span class="error" id="phoneError"></span>
				<p>
					Phone Number<br />
					<small>Phone number where text alerts are sent</small><br />
					<input placeholder="e.g. 8015555555" type="text" name="phoneNumber" id="phoneNumber"/>
				</p>
				
				<span class="error" id="emailError"></span>
				<p>
					Email<br />
					<small>(optional)</small><br />
					<input placeholder="e.g. you@gmail.com" type="text" name="email" id="email"/>
				</p>
				
				<span class="error" id="passwordError"></span>
				<p>
					Password<br />
					<input placeholder="" type="password" name="password" id="password"/>
				</p>

				<p>
					Password (again)<br />
					<input placeholder="" type="password" name="password2" id="password2"/>
				</p>

			</div>

			<div class="right">
				<p>Drag the dropped pin to your central location. You will receive messages for any alert that is within your blue circle.</p>
				<div id="googleMap" style="width:100%;height:350px;z-index:1000"></div>
				<p style="text-align:center;">
					<span class="button blackBorder orangeBG" onclick="signUp()">Save and Finish</span>
				</p>
			</div>
			
			<div style="clear: both">&nbsp;</div>
		</div>
	</div>

	<div class="inverted wide section">
		<div class="content">
			<h2><a name="faq"></a>Frequently Asked Questions</h2>

			<p>
				<b>How many messages will I receive?</b><br />
				This is entirely dependent on your local law enforcement agency.  If you live in an area where there are many missing person alerts, you may receive several messages.  If you feel like you are receiving too many alerts, you are welcome to log back in and make your location area smaller.  (I didn’t know that we could dictate the size of our location area.)
			</p>

			<p>
				<b>Who has access to my personal sign up information?</b><br />
				SARA holds your personal information in a secure database that is used to send alerts based on your location and the location of the missing person.  The database is not shared with anyone outside of SARA.
			</p>

			<p>
				<b>Is SARA a government agency?</b><br />
				No. SARA is a private company founded by concerned citizens who wish to help find missing children. SARA does work closely with and provide support to local and national government agencies, police departments, cities and other private organizations.
			</p>

			<p>
				<b>Isn't this the same as an Amber Alert?</b><br />
				No.  The Amber Alert system is set up for only certain situations and must meet certain strict criteria in order to be released to the public.  It must be a child under the age of 17 who is believed to be abducted and is in danger of serious bodily injury or death.  The case must be filed with the NCIC National Crime Information Center.  This makes it impossible to send an Amber Alert for older persons, runaways, and those who are lost – even those with diminished capacity.  The Amber Alert system is a life-saving system, but leaves out many important cases that could be solved with a little help from the public.
			</p>

		</div>
	</div>

	<div id="footer" class="wide gray section">
		<p>
			<h3>Site Map</h3>
			<ul>
				<li><a href="">Home</a></li>
				<li><a href="">Sign Up</a></li>
				<li><a href="">Log In</a></li>
				<li><a href="">My Account</a></li>
				<li><a href="">Administrator Log In</a></li>
			</ul>
		</p>

		<br />
		<p>&copy; Search and Rescue Alerts, LLC 2014</p>
	</div>

</div>

</center>

<script href="./config/passport.js"></script>

<script>
function login() {
	var user = {
		"email": "",
		"password": ""
	}

	user.email = $("#email").val();
	user.password = $("#password").val();

	//or get the values from the header if these values of blank
	if (!user.email && !user.password) {
		user.email = $("#emailHeader").val();
		user.password = $("#passwordHeader").val();
	}

	// console.log(user.email + " & " + user.password + " was sent to /login");
	$.post("/login", user).done(function(data){
		console.log('inside post login done function');
		user = data;
		window.location.href = '/myaccount/' + user.id;
	});
}

function signUp() {
	//clear the error messages
	$("#phoneError").text("");
	$("#passwordError").text("");
	$("#emailError").text("");
	
	//get the values
	var email = $("#email").attr("value");
	var phone = $("#phoneNumber").attr("value");
	var password = $("#password").attr("value");
	var password2 = $("#password2").attr("value");

	// check that all fields are filled in
	if (phone == 0) {
		console.log("No phone number");
		$("#phoneError").text("Please enter a phone number");
		return "";
	}
	if (password == 0 || password2 == 0) {
		console.log("No password");
		$("#passwordError").text("Please enter your password twice");
		return "";
	}
	// having no email is fine because that field is optional

	// SARAH TODO:
	// validate that the email is a valid email address

	// validate that the two passwords match
	if (password != password2) {
		//set the two password fields to empty string
		$("#password").val("");
		$("#password2").val("");
		console.log("Passwords did not match. Please re-enter your password");
		$("#passwordError").text("Passwords did not match. Please re-enter your password");
		return;
	}

	// SARAH TODO: hash the password here instead of sending it off to get hashed
	// var passwordHash = require('./node_modules/password-hash');
    // var hashedPassword = passwordHash.generate('password123');
    // console.log(hashedPassword); // sha1$3I7HRwy7$cbfdac6008f9cab4083784cbd1874f76618d2a97

	//create the user object
	var user = {
		"email": email,
		"password": password,
		"phone": phone,
		"locations": {
			"lat": marker.position.lat(),
			"lng": marker.position.lng(),
			"radius": circle.radius //store this in meters
		}
	}

	console.log(user);
	
	//send value to the right URL
	$.post("/api/v1/user", user).done(function(data){
		// console.log('inside post signup done function');
		// user = data;
		// window.location.href = '/myaccount/' + user.id;
	});
}

</script>

</body>
</html>